<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Chapter 8: Integrating AI</title>
	<link rel="short icon" type="image/png" href="./asset/favicon.png">
	
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link
		href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
		rel="stylesheet"/>
	<link rel="stylesheet" type="text/css" href="./asset/css/reset.css">
	<link rel="stylesheet" type="text/css" href="./asset/css/root.css">
	<link rel="stylesheet" type="text/css" href="./asset/css/intro.css">
	<link rel="stylesheet" type="text/css" href="./asset/css/highlight.css">
</head>
<body>
<main>
	<section class="nav">
		<div class="sidebar">
	<header class="nav-hdr">
		<h1><a href="/">Automated <span>Agents</span></a></h1>
	</header>
	<nav class="nav-list">
		<ul class="sidebar"><li class="nav-part "><h2><a href="content.html">Table of Content</a></h2></li><li class="nav-part "><h2>Front</h2><ul><li class="nav-chapt "><a href="intro.html"  title="Introduction">Introduction</a></li></ul></li><li class="nav-part "><h2><a href="part-one-intro.html">Understanding Chatbots</a></h2><ul><li class="nav-chapt "><a href="chapter-1.html"  title="A Place to Start">CH01: A Place to Start</a></li><li class="nav-chapt "><a href="chapter-2.html"  title="Solving People Problems">CH02: Solving People Problems</a></li><li class="nav-chapt "><a href="chapter-3.html"  title="Integration">CH03: Integration</a></li><li class="nav-chapt "><a href="chapter-4.html"  title="Artificial Intelligence">CH04: Artificial Intelligence</a></li><li class="nav-chapt "><a href="chapter-5.html"  title="The Core Application">CH05: The Core Application</a></li><li class="nav-chapt "><a href="chapter-6.html"  title="Protecting Users">CH06: Protecting Users</a></li></ul></li><li class="nav-part selected"><h2><a href="part-two-intro.html">Under the Hood</a></h2><ul><li class="nav-chapt "><a href="chapter-7.html"  title="The Chat Application">CH07: The Chat Application</a></li><li class="nav-chapt selected"><a href="chapter-8.html"  title="Integrating AI">CH08: Integrating AI</a></li><li class="nav-chapt "><a href="chapter-9.html"  title="Integrating a Help Desk">CH09: Integrating a Help Desk</a></li><li class="nav-chapt "><a href="chapter-10.html"  title="Integrating an eCommerce Platform">CH10: Integrating an eCommerce Platform</a></li><li class="nav-chapt "><a href="chapter-11.html"  title="Integrating a Carrier">CH11: Integrating a Carrier</a></li><li class="nav-chapt "><a href="chapter-12.html"  title="Designing a Company Policy Processor">CH12: Designing a Company Policy Processor</a></li></ul></li><li class="nav-part "><h2><a href="part-three-intro.html">Beyond eCommerce</a></h2></li></ul>
	</nav>
</div>
	</section>
	<section class="content">
		<article>
			<header class="chapt-hdr"><p class="chapt-hdr__sub"><strong>Chapter 8</strong></p><h1 class="chapt-hdr__title">Integrating AI</h1></header>
			
			<p>Incorporating AI into your chatbot doesn’t mean you have to build everything from scratch. There are powerful, well-established tools that can streamline this process, allowing you to focus on integrating and refining AI components rather than reinventing the wheel.</p>
<p>One such tool is <strong>spaCy</strong>, an advanced Natural Language Processing (NLP) library that's well-suited for many of the tasks required in an eCommerce chatbot. SpaCy offers out-of-the-box solutions for essential functions like entity recognition, intent classification, and sentiment analysis. These capabilities can be leveraged to enhance your chatbot's ability to understand and respond to customer queries effectively.</p>
<p><strong>1. Entity Recognition</strong>: SpaCy’s entity recognition models can identify important pieces of information within customer messages, such as order numbers, product names, or dates. By recognizing these entities, your application can better understand the context of the customer’s request.</p>
<p><strong>2. Intent Classification</strong>: One of the most crucial tasks for any chatbot is determining what the customer wants—whether they're asking about an order, inquiring about return policies, or seeking product information. SpaCy can be used to build an intent classifier, a model that categorizes customer messages into predefined intents.</p>
<p><strong>3. Sentiment Analysis</strong>: Understanding the tone of a customer’s message can be just as important as understanding its content. By incorporating sentiment analysis, your chatbot can detect whether a customer is frustrated, confused, or satisfied, allowing it to adjust its responses accordingly.</p>
<h2><strong>Building AI Services Independently</strong></h2>
<p>To integrate these AI capabilities, you can develop an independent service that takes different models as parameters to fulfill specific needs. This modular approach allows you to scale and customize your AI components as your chatbot's requirements evolve.</p>
<p><strong>Pretrained Models as a Baseline</strong></p>
<p>Starting from scratch isn’t necessary when there are numerous pretrained models available online. These models serve as a solid baseline, allowing you to focus on refining and adapting them to your specific use cases. By creating a training pipeline, you can continuously improve these models based on real-world data from your application.</p>
<h2>Example: Classifying "Where is My Order" (WISMO) Intents</h2>
<p>Let's take a closer look at how you might use spaCy to build a classifier for "Where is My Order" (WISMO) intents. Below is a simplified example in pseudo code:</p>
<pre><code class="language-python"><span class="hljs-keyword">import</span> spacy  
<span class="hljs-keyword">from</span> spacy.util <span class="hljs-keyword">import</span> minibatch, compounding

<span class="hljs-comment"># Load a pretrained spaCy model  </span>
nlp = spacy.load(<span class="hljs-string">&quot;en_core_web_sm&quot;</span>)

<span class="hljs-comment"># Define training data  </span>
training_data = [  
    (<span class="hljs-string">&quot;Where is my order?&quot;</span>, {<span class="hljs-string">&quot;cats&quot;</span>: {<span class="hljs-string">&quot;WISMO&quot;</span>: <span class="hljs-number">1.0</span>, <span class="hljs-string">&quot;Other&quot;</span>: <span class="hljs-number">0.0</span>}}),  
    (<span class="hljs-string">&quot;I need to know the status of my package&quot;</span>, {<span class="hljs-string">&quot;cats&quot;</span>: {<span class="hljs-string">&quot;WISMO&quot;</span>: <span class="hljs-number">1.0</span>, <span class="hljs-string">&quot;Other&quot;</span>: <span class="hljs-number">0.0</span>}}),  
    (<span class="hljs-string">&quot;What is your return policy?&quot;</span>, {<span class="hljs-string">&quot;cats&quot;</span>: {<span class="hljs-string">&quot;WISMO&quot;</span>: <span class="hljs-number">0.0</span>, <span class="hljs-string">&quot;Other&quot;</span>: <span class="hljs-number">1.0</span>}}),  
    <span class="hljs-comment"># Add more examples  </span>
]

<span class="hljs-comment"># Add the text categorizer to the pipeline if it doesn&#x27;t exist  </span>
<span class="hljs-keyword">if</span> <span class="hljs-string">&quot;textcat&quot;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> nlp.pipe_names:  
    textcat = nlp.create_pipe(<span class="hljs-string">&quot;textcat&quot;</span>)  
    nlp.add_pipe(textcat, last=<span class="hljs-literal">True</span>)  
<span class="hljs-keyword">else</span>:  
    textcat = nlp.get_pipe(<span class="hljs-string">&quot;textcat&quot;</span>)

<span class="hljs-comment"># Add labels to the text classifier  </span>
textcat.add_label(<span class="hljs-string">&quot;WISMO&quot;</span>)  
textcat.add_label(<span class="hljs-string">&quot;Other&quot;</span>)

<span class="hljs-comment"># Training loop  </span>
optimizer = nlp.begin_training()  
<span class="hljs-keyword">for</span> epoch <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):  
    losses = {}  
    batches = minibatch(training_data, size=compounding(<span class="hljs-number">4.0</span>, <span class="hljs-number">32.0</span>, <span class="hljs-number">1.001</span>))  
    <span class="hljs-keyword">for</span> batch <span class="hljs-keyword">in</span> batches:  
        texts, annotations = <span class="hljs-built_in">zip</span>(*batch)  
        nlp.update(texts, annotations, sgd=optimizer, drop=<span class="hljs-number">0.2</span>, losses=losses)  
    <span class="hljs-built_in">print</span>(losses)

<span class="hljs-comment"># Save the model  </span>
nlp.to_disk(<span class="hljs-string">&quot;wismo_classifier&quot;</span>)

<span class="hljs-comment"># Test the classifier  </span>
doc = nlp(<span class="hljs-string">&quot;Can you tell me where my order is?&quot;</span>)  
<span class="hljs-built_in">print</span>(doc.cats)
</code></pre>
<p>In this pseudo code, we've defined a simple pipeline using spaCy to train a classifier for WISMO intents. This classifier can then be integrated into your chatbot's AI service to detect when customers are inquiring about their order status.</p>
<h2><strong>Exploring Other Tools</strong></h2>
<p>While spaCy is a powerful and versatile tool, it's just one of many options available. For example, <strong>FastText</strong> is another widely-used NLP library that excels in text classification tasks. Depending on your specific needs, you might find that other open-source tools better fit your use case.</p>
<p>The key takeaway is that integrating AI into your chatbot doesn't require building everything from scratch. By leveraging existing tools and resources, you can rapidly develop and deploy AI components that enhance your chatbot's ability to serve customers effectively.</p>


			<div class="article-nav">
				<div>
					<a href="chapter-7.html">&larr; CH07: The Chat Application</a>
				</div>
				<div>
					<a href="chapter-9.html">CH09: Integrating a Help Desk &rarr;</a>
				</div>
			</div>
			<div class="github">
				<p><img src="./asset/images/github-mark.svg" alt="github" /> <a href="https://github.com/ibudiallo/automated-agents-book/blob/master/book/part-two/c08.md"  target="_blank">Github Source</a></p>
			</div>

			<footer>
				<p>Written and Designed by Ibrahim Diallo &mdash; <span>2024</span></p>
			</footer>
		</article>

	</section>
</main>
</body>
</html>